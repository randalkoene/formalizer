</tbody>
</table>

<hr>

<p><a href="/cgi-bin/fzgraphhtml-cgi.py?all=on&max_td={{ thirty_days_more }}">Show 30 days more</a></p>

<hr>

<p>[<a href="/index.html">fz: Top</a>]</p>

<script>
var darkmode = 0;
function set_darkmode() {
    if (darkmode < 1) {
        document.body.removeAttribute('data-theme');
    } else {
        document.body.setAttribute('data-theme', 'dark');
    }
}
function switch_light_or_dark() {
    darkmode = 1 - darkmode;
    set_darkmode();
}
function init_darkmode() {
    set_darkmode();
}
// Let's make out state storable
const darkmodebutton = document.getElementById('darkmode');
function sendData( data ) {
  const XHR = new XMLHttpRequest(),
        FD  = new FormData();
  for( name in data ) {
    FD.append( name, data[ name ] );
  }
  XHR.addEventListener( 'load', function( event ) {
    console.log( 'Darkmode setting stored, response loaded.' );
  } );
  XHR.addEventListener(' error', function( event ) {
    console.error( 'Failed to communicate darkmode setting.' );
  } );
  XHR.open( 'POST', '/cgi-bin/fzuistate.py' );
  XHR.send( FD );
}
darkmodebutton.addEventListener( 'click', function()
    { sendData( { 'darkmode' : darkmode } );
} )

// Let's read state
var uistate = new XMLHttpRequest();
uistate.onreadystatechange = function() {
    if (this.readyState == 4) {
        if (this.status == 200) {
            // Parse UI state
            console.log(uistate.response);
            var state_data = uistate.responseText;
            var json_uistate = JSON.parse(state_data);
            if (json_uistate.hasOwnProperty('darkmode')) {
                darkmode = json_uistate['darkmode'];
                set_darkmode();
            }
        } else {
            console.error('State loading failed.');
            // default init
            init_darkmode();
        }
    }
};
uistate.open( 'GET', '/cgi-bin/fzuistate.py' );
uistate.send(); // no form data presently means we're requesting state
</script>
</body>
</html>
