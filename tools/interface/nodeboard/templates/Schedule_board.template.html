<!DOCTYPE html>
<html style="overflow-x:scroll;">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<link rel="icon" href="/favicon-schedule-32x32.png">
<link rel="stylesheet" href="/fz.css">
<!-- https://www.w3schools.com/w3css/4/w3.css -->
<link rel="stylesheet" href="/w3.css">
<link rel="stylesheet" href="/fzuistate.css">
<link rel="stylesheet" href="/clock.css">
<style>
.grid-container {
  display: grid;
  grid-template-columns:{{ column-widths }};
  {{ row-heights  }}
  grid-gap: 5px 5px;
  background-color: var(--grid-bg);
  color: black;
  padding: 5px;
  overflow-x: scroll;
  width: fit-content;
  position: absolute;
  left: 20px;
}

.grid-container > div {
  background-color: var(--grid-bgoverlay);
  text-align: left;
  padding: 5px;
  font-size: 12px;
}

.schedule-column-container {
  display: grid;
  grid-template-columns:{{ column-widths }};
  grid-gap: 5px;
  background-color: var(--grid-bg);
  /*padding: 5px;*/
  align-content: flex-start;
  height: 90vh;
  position: relative;
}

.schedule-column-container > div {
  background-color: var(--grid-bgoverlay);
  text-align: left;
  /*padding: 5px;*/
  font-size: 10px;
  margin: 5px;
}

/*.schedule-column-content {
  position: absolute;
}*/

.w3-card-4 {
  border-radius: 20px;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  width: {{ card-width }};
  position: absolute;
  text-align: left;
  overflow: hidden;
}

.w3-card-4:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.4);
  z-index:555555 !important;
  height: 120px !important;
  background-color: rgba(255, 255, 0, 1.0) !important;
}

.container {
  padding: 0px 16px;
}

.passed_overlay {
  z-index:333333 !important;
  background-color: rgba(33,33,33,0.5) !important;
  position: absolute;
  overflow: hidden;
  width: {{ card-width }};
}

#protocol_tab {
z-index:333333 !important;
position: fixed;
top: 185px;
right: 0px;
width: 300px;
height: 500px;
display: block;
text-align: right;
}
/* Define the flashing sequence */
@keyframes warning-flash {
  0% { background-color: #ff0000; color: white; }    /* Bright Red */
  50% { background-color: #8b0000; color: #cccccc; } /* Dark Red */
  100% { background-color: #ff0000; color: white; }   /* Back to Bright */
}

/* The class that triggers the flash */
.flashing {
  animation: warning-flash 0.8s infinite; /* Cycles every 0.8 seconds forever */
  border: 2px solid white;
  box-shadow: 0 0 10px rgba(255, 0, 0, 0.8); /* Optional glow effect */
}

/* Basic button styling */
#my-button {
  padding: 10px 20px;
  background-color: #ccc;
  cursor: pointer;
  transition: all 0.3s;
}

h4 {
  text-align: center;
}
</style>
<title>{{ board-header }}</title>
</head>
<body>
<script type="text/javascript" src="/clock.js"></script>
<div id="protocol_tab">
<button id="WeekGoals" class="button button2" onclick="window.open('/cgi-bin/nodeboard-cgi.py?D=week_main_goals&T=true&u={{ week-TD }}&r=100&U=true', '_blank');">Week Goals</button><br>
<button id="DayWiz" class="button button1" onclick="window.open('/cgi-bin/daywiz.py', '_blank');">DayWiz</button>
</div>

<h2>{{ board-header }} {{ post-extra }}</h2>

<!-- call comment: {{ call-comment }} -->

{{ board-extra }}

<div class="grid-container">

{{ the-columns }}

</div>

<script type="text/javascript" src="/fzuistate.js"></script>
<script type="module">
function startWarning(btn_id) {
    document.getElementById(btn_id).classList.add('flashing');
}
function stopWarning(btn_id) {
    document.getElementById(btn_id).classList.remove('flashing');
}
async function getIndicatorsData(url, targetKey) {
  try {
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    const data = await response.json();
    
    if (data['WeekGoals_Overdue']['state']) {
        startWarning('WeekGoals');
    } else {
        stopWarning('WeekGoals');
    }
    if (data['DayWiz_Overdue']['state']) {
        startWarning('DayWiz');
    } else {
        stopWarning('DayWiz');
    }
    
    //console.log(`The data is:`, data);
    //return data;

  } catch (error) {
    console.error("Failed to fetch or parse JSON:", error);
  }
}
const IndicatorsDataUrl = '/formalizer/indicators.json';
setInterval(() => {
  getIndicatorsData(IndicatorsDataUrl);
}, 10000); // every 10 seconds
</script>
</body>
</html> 
