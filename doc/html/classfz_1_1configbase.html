<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formalizer: fz::configbase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="formalizer-logo-20200907-41x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Formalizer
   &#160;<span id="projectnumber">2.0.0-0.1</span>
   </div>
   <div id="projectbrief">The Formalizer System Support Environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacefz.html">fz</a></li><li class="navelem"><a class="el" href="classfz_1_1configbase.html">configbase</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classfz_1_1configbase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fz::configbase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the base component for Formalizer configuration file configuration parameter loading and parsing.  
 <a href="classfz_1_1configbase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="config_8hpp_source.html">config.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for fz::configbase:</div>
<div class="dyncontent">
<div class="center"><img src="classfz_1_1configbase__inherit__graph.png" border="0" usemap="#fz_1_1configbase_inherit__map" alt="Inheritance graph"/></div>
<map name="fz_1_1configbase_inherit__map" id="fz_1_1configbase_inherit__map">
<area shape="rect" id="node2" href="classfz_1_1configurable.html" title="Formalizer standard programs that can use configuration files should include a class that inherits co..." alt="" coords="99,80,209,107"/>
<area shape="rect" id="node5" href="classfz_1_1err__configbase.html" title="fz::err_configbase" alt="" coords="233,80,360,107"/>
<area shape="rect" id="node3" href="classfz_1_1fzpq__configurable.html" title="fz::fzpq_configurable" alt="" coords="5,155,148,181"/>
<area shape="rect" id="node4" href="classfzlh__configurable.html" title="fzlh_configurable" alt="" coords="173,155,293,181"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aef2522cfbd724554b478fc7ba057afae"><td class="memItemLeft" align="right" valign="top"><a id="aef2522cfbd724554b478fc7ba057afae"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>configbase</b> (std::string thisprogram)</td></tr>
<tr class="separator:aef2522cfbd724554b478fc7ba057afae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54418af1a3fd4f99c9433fa76760912"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#ab54418af1a3fd4f99c9433fa76760912">set_parameter</a> (const std::string &amp;parlabel, const std::string &amp;parvalue)=0</td></tr>
<tr class="memdesc:ab54418af1a3fd4f99c9433fa76760912"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method must be defined in configurable Formalizer components and programs that define a class inheriting <code>configurable</code>.  <a href="#ab54418af1a3fd4f99c9433fa76760912">More...</a><br /></td></tr>
<tr class="separator:ab54418af1a3fd4f99c9433fa76760912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2537c2f6edc9e42031bfb674094d823"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823">load</a> ()</td></tr>
<tr class="memdesc:ae2537c2f6edc9e42031bfb674094d823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function from a place where it is guaranteed to be run before the configurable parameters are used.  <a href="#ae2537c2f6edc9e42031bfb674094d823">More...</a><br /></td></tr>
<tr class="separator:ae2537c2f6edc9e42031bfb674094d823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bfe92ee9e27b90df84ad47aabd0e13e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#a7bfe92ee9e27b90df84ad47aabd0e13e">reset</a> ()</td></tr>
<tr class="memdesc:a7bfe92ee9e27b90df84ad47aabd0e13e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides explicit reset of the <code>processed</code> flag.  <a href="#a7bfe92ee9e27b90df84ad47aabd0e13e">More...</a><br /></td></tr>
<tr class="separator:a7bfe92ee9e27b90df84ad47aabd0e13e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d489760ed4dddb05aa0d768eefd7a7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#a65d489760ed4dddb05aa0d768eefd7a7">parse</a> (std::string &amp;configcontentstr)</td></tr>
<tr class="memdesc:a65d489760ed4dddb05aa0d768eefd7a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The configuration file contents parsing function is called by <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> and does not need to be called directly.  <a href="#a65d489760ed4dddb05aa0d768eefd7a7">More...</a><br /></td></tr>
<tr class="separator:a65d489760ed4dddb05aa0d768eefd7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1df3a69094857d9b0eec843f089444a"><td class="memItemLeft" align="right" valign="top"><a id="ab1df3a69094857d9b0eec843f089444a"></a>
const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_configfile</b> () const</td></tr>
<tr class="separator:ab1df3a69094857d9b0eec843f089444a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a482e4c921251546491fe9a066b7af728"><td class="memItemLeft" align="right" valign="top"><a id="a482e4c921251546491fe9a066b7af728"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#a482e4c921251546491fe9a066b7af728">configfile</a></td></tr>
<tr class="memdesc:a482e4c921251546491fe9a066b7af728"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is set in the constructor. <br /></td></tr>
<tr class="separator:a482e4c921251546491fe9a066b7af728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e58944e0e1450325f6243151f3f10f"><td class="memItemLeft" align="right" valign="top"><a id="af0e58944e0e1450325f6243151f3f10f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfz_1_1configbase.html#af0e58944e0e1450325f6243151f3f10f">processed</a></td></tr>
<tr class="memdesc:af0e58944e0e1450325f6243151f3f10f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag used to ensure a configuration file is normally processed only once. <br /></td></tr>
<tr class="separator:af0e58944e0e1450325f6243151f3f10f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the base component for Formalizer configuration file configuration parameter loading and parsing. </p>
<p>Formalizer library components can use this base directly for the configuration of predictably located global configuration parameters. (See, for example, how the <code>standard</code> library component applies this in <code>init()</code> with the <code>ErrQ</code> and <code>WarnQ</code> global targets.) In other cases, where programs use parameters provided by local struct or class definitions that are not always around and in restricted scope, they should instead inherit the <code>configurable</code> class below.</p>
<p>This class enforces method implementation for <code><a class="el" href="classfz_1_1configbase.html#ab54418af1a3fd4f99c9433fa76760912" title="This method must be defined in configurable Formalizer components and programs that define a class in...">set_parameter()</a></code>. The <code>configurable</code> class also enforces method implementation for <code>init()</code>, as well as registration in a <code>init_register_stack</code> so that configuration files are guaranteed to be parsed upon entering <code>main()</code> in a standardized program. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ae2537c2f6edc9e42031bfb674094d823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2537c2f6edc9e42031bfb674094d823">&#9670;&nbsp;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fz::configbase::load </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this function from a place where it is guaranteed to be run before the configurable parameters are used. </p>
<p>Load the configuration file indicated by <code>configfile</code>, parse the contents and set parameters through calls to <code><a class="el" href="classfz_1_1configbase.html#ab54418af1a3fd4f99c9433fa76760912" title="This method must be defined in configurable Formalizer components and programs that define a class in...">set_parameter()</a></code>.</p>
<p>Logically, it should be called before command line parameters are parsed (see <a href="https://trello.com/c/eJPHqQdC">https://trello.com/c/eJPHqQdC</a>).</p>
<p>In <code><a class="el" href="classfz_1_1formalizer__standard__program.html" title="This class provides a framework for standardized Formalizer programs. ">formalizer_standard_program</a></code> code that defines an <code>init_top()</code> function (which calls the standard <code>init()</code>), a natural fit is to make this call at the top of that function, before the call to <code>init()</code>.</p>
<p>The better choice is now to use the <code><a class="el" href="classfz_1_1main__init__register.html" title="Classes that need an initialization function to be called first-thing upon entering main() (but not b...">main_init_register</a></code> approach available by inheriting the <code>configurable</code> class (below).</p>
<p>In <code><a class="el" href="classfz_1_1formalizer__standard__program.html" title="This class provides a framework for standardized Formalizer programs. ">formalizer_standard_program</a></code> code and in core components that provide command line configuration hooks (e.g. fzpostgres) AND that require at least one mandatory command line argument, a natural fit could be to call this function at the top of <code>options_hook()</code>, because that guarantees that it will be run just like command line parsing will be run, and it will occur before corresponding parameters are set on the command line.</p>
<p>BEWARE: While tempting, do NOT call <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> from the global variable constructor of the class that inherits configurable. The order in which global variables from different translation units (source files) are initialized is undefined! This means segfaults that are difficult to track down may occur, for example if the <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> function calls a function in <code>error.cpp</code>. See, for example, <a href="https://trello.com/c/rjFzbRpT">https://trello.com/c/rjFzbRpT</a>.</p>
<p>Don't worry about multiple calls (as can happen within options_hook()). This function checks and sets a flag to ensure it processes the configuration file only once (unless the flag is explicitly reset).</p>
<p>It can be useful to embed the <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> call in some error reporting code (see for example <code>fzloghtml</code>).</p>
<dl class="section return"><dt>Returns</dt><dd>True if configuration processing was successful or if the <code>processed</code> flag was already set.</dd></dl>
<p>Note: It is not an error if a configuration file does not exist. That just means that no parameters have been specified and defaults are used. Not finding a configuration file does generate a warning.</p>
<dl class="section return"><dt>Returns</dt><dd>True if the configuration file was successfully loaded and parsed. </dd></dl>

</div>
</div>
<a id="a65d489760ed4dddb05aa0d768eefd7a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d489760ed4dddb05aa0d768eefd7a7">&#9670;&nbsp;</a></span>parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fz::configbase::parse </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>configcontentstr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The configuration file contents parsing function is called by <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> and does not need to be called directly. </p>
<p>Parse the contents of a configuration file.</p>
<p>It is made available as a public method, because it can also be used as a way to configure parameters by label. That might be useful for web interfaces and other means by which parameters can be specified interactively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configcontentstr</td><td>A string containing parameter-value pairs in a format that is a JSON subset without nesting. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if configuration parsing was successfully completed.</dd></dl>
<p>Enclosing brackets are optional. Parameter-value assignments are assumed to be separated by a colon and each surrounded by double quotes. For more about this JSON subset format, see the README.md file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configcontentstr</td><td>A string containing the contents of the configuration file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the configuration contents were successfully parsed. </dd></dl>

</div>
</div>
<a id="a7bfe92ee9e27b90df84ad47aabd0e13e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bfe92ee9e27b90df84ad47aabd0e13e">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void fz::configbase::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Provides explicit reset of the <code>processed</code> flag. </p>
<p>This can be useful if a program provides an interface for modifying a configuration file and if it wishes to call <code><a class="el" href="classfz_1_1configbase.html#ae2537c2f6edc9e42031bfb674094d823" title="Call this function from a place where it is guaranteed to be run before the configurable parameters a...">load()</a></code> again to activate the modified parameter settings. </p>

</div>
</div>
<a id="ab54418af1a3fd4f99c9433fa76760912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab54418af1a3fd4f99c9433fa76760912">&#9670;&nbsp;</a></span>set_parameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool fz::configbase::set_parameter </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>parlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>parvalue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method must be defined in configurable Formalizer components and programs that define a class inheriting <code>configurable</code>. </p>
<p>It is called by <code><a class="el" href="classfz_1_1configbase.html#a65d489760ed4dddb05aa0d768eefd7a7" title="The configuration file contents parsing function is called by load() and does not need to be called d...">parse()</a></code> and does not need to be called directly. It is provided as a public method here, because it can also be used as a way to configure a specific parameter by label. That may be useful for web interfaces and other means by which parameters can be specified interactively.</p>
<dl class="section return"><dt>Returns</dt><dd>True if a parameter was set or no legible parlabel or parvalue was given, False if a proper parlabel string was extracted, but the corresponding parameter was not recognized (possibly a syntax error in the parlabel). </dd></dl>

<p>Implemented in <a class="el" href="classfz_1_1err__configbase.html#a0a1913d0e4ff1fb5054257fc8914d020">fz::err_configbase</a>, <a class="el" href="classfz_1_1fzpq__configurable.html#ae4fbaf9fc0f021ee4408f79548d377a9">fz::fzpq_configurable</a>, and <a class="el" href="classfzlh__configurable.html#a68038c0e28359b3ec965247cbfaf43bf">fzlh_configurable</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>core/include/<a class="el" href="config_8hpp_source.html">config.hpp</a></li>
<li>core/lib/config.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
